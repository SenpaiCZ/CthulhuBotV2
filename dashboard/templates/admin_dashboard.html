{% extends 'base.html' %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<h2 class="mb-4">Admin Dashboard</h2>

<h3 class="mb-3">Keeper Tools</h3>
<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Monsters</h5>
                <p class="card-text">View the Grimoire of Monsters.</p>
                <a href="/monsters" class="btn btn-primary" style="background-color: #8a0303; border-color: #8a0303;">Open Grimoire</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Deities</h5>
                <p class="card-text">View the Pantheon of Deities.</p>
                <a href="/deities" class="btn btn-primary" style="background-color: #8a0303; border-color: #8a0303;">Open Pantheon</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Game Settings</h5>
                <p class="card-text">Configure gameplay rules (Luck Threshold, etc).</p>
                <a href="/admin/game_settings" class="btn btn-primary" style="background-color: #20c997; border-color: #20c997;">Game Settings</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Info Data</h5>
                <p class="card-text">Manage game data (Occupations, Skills, Items).</p>
                <a href="/admin/browse/infodata" class="btn btn-secondary">Browse Info Data</a>
            </div>
        </div>
    </div>
</div>

<h3 class="mb-3 mt-4">Audio</h3>
<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Soundboard</h5>
                <p class="card-text">Play audio files in voice channels.</p>
                <a href="/admin/soundboard" class="btn btn-success">Open Soundboard</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Music Bot</h5>
                <p class="card-text">Manage music queue and bans.</p>
                <a href="/admin/music" class="btn btn-info">Open Music Panel</a>
            </div>
        </div>
    </div>
</div>

<h3 class="mb-3 mt-4">Server Administration</h3>
<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Reaction Roles</h5>
                <p class="card-text">Assign roles via message reactions.</p>
                <a href="/admin/reactionroles" class="btn btn-primary" style="background-color: #6f42c1; border-color: #6f42c1;">Manage Roles</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Karma System</h5>
                <p class="card-text">Configure reaction channel and emojis.</p>
                <a href="/admin/karma" class="btn btn-primary" style="background-color: #fd7e14; border-color: #fd7e14;">Manage Karma</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Server Prefixes</h5>
                <p class="card-text">Manage prefixes for each connected server.</p>
                <a href="/admin/prefixes" class="btn btn-primary">Manage Prefixes</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">RSS Feeds</h5>
                <p class="card-text">Manage RSS subscriptions and channels.</p>
                <a href="/admin/rss" class="btn btn-warning">Manage Feeds</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Auto Rooms</h5>
                <p class="card-text">Configure automatic voice channel creation.</p>
                <a href="/admin/autorooms" class="btn btn-primary" style="background-color: #6610f2; border-color: #6610f2;">Manage Auto Rooms</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Auto Deleter</h5>
                <p class="card-text">Manage auto-deletion rules and bulk delete.</p>
                <a href="/admin/deleter" class="btn btn-danger">Manage Auto Deleter</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Backup System</h5>
                <p class="card-text">Manage automated backups and run manual backups.</p>
                <a href="/admin/backup" class="btn btn-secondary">Manage Backups</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Data Files</h5>
                <p class="card-text">Manage raw data files (Stats, Servers, etc).</p>
                <a href="/admin/browse/data" class="btn btn-warning">Browse Data Files</a>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card border-danger">
            <div class="card-body">
                <h5 class="card-title text-danger">System Update</h5>
                <p class="card-text">Update the bot to the latest version from GitHub and restart.</p>
                <button class="btn btn-danger" onclick="confirmUpdate()">Update Bot</button>
            </div>
        </div>
    </div>
</div>

<script>
async function confirmUpdate() {
    if (confirm("Are you sure you want to update the bot? This will restart the system.")) {
        try {
            const response = await fetch('/api/admin/update', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            });
            const data = await response.json();
            if (data.status === 'success') {
                alert(data.message);
                // Optionally disable UI or show loader
            } else {
                alert('Update failed: ' + data.message);
            }
        } catch (error) {
            alert('Error connecting to server: ' + error);
        }
    }
}
</script>
{% endblock %}
